---
title: å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“
tags:
  - æ·±åº¦å­¦ä¹ 
  - R-CNN
  - SPPnet
  - Fast R-CNN
  - Faster R-CNN
  - å›¾åƒæ£€æµ‹
categories:
  - è®¡ç®—æœºç§‘å­¦
description: è¿™æ˜¯å…³äºå›¾åƒæ£€æµ‹ç¥ç»ç½‘ç»œçš„å­¦ä¹ æ€»ç»“
mathjax: true
date: 2018-04-14 15:50:12
---

> R-CNNçš„æå‡ºæ˜¯å¼€åˆ›æ€§çš„ï¼Œå®ƒæ˜¯ç¬¬ä¸€æ¬¡ç»“åˆäº†ç¥ç»ç½‘ç»œçš„ç®—æ³•åœ¨å›¾åƒæ£€æµ‹ä¸­å¾—åˆ°åº”ç”¨
>
> è¿™é‡Œæˆ‘æ‰“ç®—å°†æˆ‘æ‰€ç†è§£çš„å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œå‘å±•è„‰ç»œåšä¸ªæ€»ç»“ï¼Œé¡ºä¾¿ç†æ¸…ä¸€ä¸‹æˆ‘çš„å¤´ç»ª

## 1. å›¾åƒæ£€æµ‹

ä¸å›¾åƒè¯†åˆ«é—®é¢˜ä¸åŒï¼Œå›¾åƒæ£€æµ‹é—®é¢˜éœ€è¦å°†ç›®æ ‡åœ¨åŸå›¾åƒä¸­çš„ä½ç½®è¯†åˆ«å‡ºæ¥ï¼Œå†åšå¯¹ç›®æ ‡çš„å›¾åƒè¯†åˆ«ã€‚

å¯ä»¥è¯´æ˜¯åŠ å…¥äº†ç›®æ ‡ä½ç½®æ£€æµ‹çš„å›¾åƒè¯†åˆ«

## 2. R-CNN

> Regions with CNN features

### 2.1 åŸºæœ¬æ¶æ„å›¾

![R-CNN](å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“/R-CNN.png)

### 2.2 åŸºæœ¬ç»“æ„åˆ†æˆä¸‰ä¸ªæ¨¡å—

- Region Proposal
  - æ¦‚å¿µï¼šä»åŸå›¾åƒä¸­æå–ç›®æ ‡å¯èƒ½çš„å­˜åœ¨çš„å€™é€‰åŒºåŸŸ
  - åœ¨è¿™ç¯‡æ–‡ç« ä¸­ä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿçš„Selective Searchingç®—æ³•ï¼ˆå…·ä½“æˆ‘ä¹Ÿæ²¡æœ‰æ·±ç©¶ï¼‰
- å›¾åƒç‰¹å¾æå–
  - é€šè¿‡ä¸€ä¸ªå¤šå±‚å·ç§¯ç½‘ç»œæå–å›¾åƒçš„ç‰¹å¾ï¼Œä¸ºä¸‹ä¸ªæ¨¡å—æä¾›å›¾åƒçš„ç‰¹å¾è¾“å…¥
- SVMåˆ†ç±»å™¨
  - ä»ä¸Šä¸ªæ¨¡å—ä¸­å¾—åˆ°çš„å›¾åƒç‰¹å¾å†åšå›¾åƒçš„åˆ†ç±»ï¼Œé€šè¿‡æ”¯æŒå‘é‡æœºçš„ç®—æ³•åšåˆ†ç±»å­¦ä¹ 

### 2.3 æ€»ç»“

1. Selective Searchingçš„æ–¹æ³•æ˜¯ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œå…¶ä¸­åªèƒ½åœ¨CPUä¸­ä½¿ç”¨ï¼Œè®¡ç®—å¤æ‚åº¦é«˜
2. å¯¹äºåœ¨æœ€åä½¿ç”¨SVMåšåˆ†ç±»å™¨æˆ‘ä¸æ˜¯å¾ˆæ‡‚ï¼Œæœ¬æ¥å¯ä»¥ç›´æ¥åœ¨ç½‘ç»œä¸­è®­ç»ƒåˆ†ç±»ï¼Œå¯æ˜¯å´æ²¡æœ‰è¿™æ ·

## 3. SPPnet

> SPPnetï¼Œå…¨ç§°Sptial Pyramid Pooling Netï¼›ä¸‹é¢æ‘˜è‡ªï¼šhttp://www.cnblogs.com/rocbomb/p/4428946.html
>
> 
>
> *SPPçš„æ€æƒ³æ¥æºäºSPMï¼Œç„¶åSPMçš„æ€æƒ³æ¥æºè‡ªBoWã€‚*
>
> *å…³äºBoWå’ŒSPMï¼Œæ‰¾åˆ°äº†ä¸¤ç¯‡ç›¸å…³çš„åšæ–‡ï¼Œå°±ä¸åœ¨è¿™é‡Œå±•å¼€äº†ã€‚*
>
> [ç¬¬ä¹ç« ä¸‰ç»­ï¼šSIFTç®—æ³•çš„åº”ç”¨â€”ç›®æ ‡è¯†åˆ«ä¹‹Bag-of-wordsæ¨¡å‹](http://blog.csdn.net/v_JULY_v/article/details/6555899)
>
> [Spatial Pyramid å°ç»“](http://blog.csdn.net/jwh_bupt/article/details/9625469)

**R-CNNå¾…è§£å†³é—®é¢˜ï¼š**R-CNNåœ¨Region Proposalä¸­å¾—åˆ°çš„é‚£äº›ProposalsåŒºåŸŸå¤§å°è§„æ ¼ä¸åŒï¼Œéœ€è¦åœ¨warpæˆ–è€…æ˜¯cropæ“ä½œï¼Œå¯¹äºå›¾åƒçš„ä¿¡æ¯æœ‰ä¸€ç‚¹å½±å“ï¼Œå¯¼è‡´å›¾åƒçš„ä¿¡æ¯ç¼ºå¤±ï¼Œæˆ–è€…å˜å¼‚

**SPPå±‚ï¼š**ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜SPPæå‡ºäº†SPPæ± åŒ–å±‚ï¼Œé€šè¿‡å¯¹conv5å¾—åˆ°çš„feature mapåšç»Ÿä¸€è§„æ ¼çš„æ± åŒ–æ“ä½œï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°å¤§å°ä¸€æ ·çš„è¾“å‡ºï¼ˆä¸»è¦æ˜¯å› ä¸ºå·ç§¯å±‚å¯¹ç»Ÿä¸€å¤§å°æ²¡æœ‰è¦æ±‚ï¼Œåªæœ‰åœ¨å…¨è¿æ¥å±‚æ‰ä¼šæœ‰è¦æ±‚ï¼Œæ‰€ä»¥éœ€è¦åœ¨å·ç§¯å±‚ä¹‹ååšç»Ÿä¸€è§„æ ¼çš„poolingï¼‰ã€‚

**é‡‘å­—å¡”ï¼š**SPPä¹‹æ‰€ä»¥å«é‡‘å­—å¡”ï¼Œæ˜¯å› ä¸ºå¯¹conv5çš„feature mapåšçš„æ˜¯å¤šä¸ªå°ºåº¦çš„è§„æ ¼åŒ–poolingï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä»»æ„çš„è¾“å…¥å¾—åˆ°çš„éƒ½æ˜¯ï¼š4x4, 2x2, 1x1å¤§å°çš„feature mapã€‚

>  SPPåç»­æ“ä½œéƒ½æ˜¯å’ŒR-CNNä¸€è‡´

![SPP](å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“/SPP.png)

**é—®é¢˜**ï¼š

1. æ— æ³•åŒæ—¶è°ƒå‚tuningå·ç§¯å±‚å’Œå…¨è¿æ¥å±‚
2. éœ€è¦åšSVMï¼Œä¹‹åé¢å¤–åšbounding box Regressor

## 4. Fast R-CNN

### 4.1 åŸºæœ¬æ¶æ„å›¾

![Fast-R-CNN](å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“/Fast-R-CNN.png)

### 4.2 åŸºæœ¬æ¨¡å—

- Region Proposal
  - ç¬¬ä¸€éƒ¨åˆ†åŸºæœ¬è¿˜æ˜¯ç”¨è€ç”Ÿå¸¸è°ˆçš„ssï¼Œé™¤å»è€ƒè™‘è¿™ä¸ªæ¨¡å—ï¼ŒFast R-CNNåŸºæœ¬å®ç°äº†ç«¯åˆ°ç«¯çš„æ€æƒ³ï¼ˆend-to-endï¼‰
- CNNåˆ†ç±»å™¨+Bounding Box Regressor
  - conv feature mapï¼šå°†æ•´ä¸ªå›¾åƒè¾“å…¥å¤šä¸ªå·ç§¯å±‚+æ± åŒ–å±‚å¾—åˆ°å·ç§¯å±‚è¾“å‡ºçš„ç‰¹å¾å›¾
  - fixed-length featureï¼šæ±‚åˆ°åŸå›¾çš„proposalsåŒºåŸŸåœ¨conv feature mapä¸­çš„æ˜ å°„ä½ç½®ï¼Œè¾“å…¥åˆ°RoI pooling layerï¼Œä½¿å¾—è¾“å‡ºå›ºå®šå¤§å°
  - RoI feature vectorï¼šå°†ä¸Šé¢å›ºå®šå¤§å°çš„ç‰¹å¾è¾“å…¥å¤šä¸ªå…¨è¿æ¥å±‚ï¼Œå¾—åˆ°ç‰¹å¾å‘é‡
  - sibling output layersï¼š
    - outputs layersï¼šè¾“å‡ºå¯¹åº”åŒºåŸŸåœ¨å„ä¸ªç±»åˆ«çš„æ£€æµ‹æ¦‚ç‡
    - bbox regressorï¼šè¾“å‡ºå¯¹åº”åŒºåŸŸå­¦ä¹ ä¼˜åŒ–çš„æ¡†çš„å¤§å°ï¼ˆç”¨äºè°ƒæ•´bounding boxçš„å°ºå¯¸å’Œä½ç½®ï¼‰
- Multi-task loss
  - output layerçš„loss
  - bbox regressorçš„loss

### 4.3 æ€»ç»“

1. æ”¹è¿›R-CNNå’ŒSPPnetä¸­çš„ç¼ºé™·
   - R-CNNå’ŒSPPnetçš„å¤šé˜¶æ®µå¤„ç†é—®é¢˜
   - æ—¶é—´ç©ºé—´å¼€é”€å¤§çš„é—®é¢˜
   - å›¾åƒæ£€æµ‹å¤ªæ…¢
   - å–æ¶ˆäº†SVMåˆ†ç±»å™¨ï¼Œç”¨ç½‘ç»œä»£æ›¿
2. è´¡çŒ®ï¼š
   - è®­ç»ƒæ˜¯å•é˜¶æ®µçš„
   - æå‡ºäº†Bounding Box Regressoræé«˜Region Proposalçš„ç²¾åº¦



## 5. Faster R-CNN

> Fast R-CNNä¸­ä»æœ‰çš„é—®é¢˜ï¼šRegion Proposalé˜¶æ®µä»æ—§ç”¨çš„æ˜¯ä¼ ç»Ÿæ–¹æ³•ï¼Œä½¿ç”¨çš„æ˜¯CPUï¼Œè®¡ç®—é€Ÿåº¦æ…¢

### 5.1 RPN

> Region Proprosol Networkï¼š
>
> Faster R-CNNæå‡ºäº†RPNç½‘ç»œçš„æ¦‚å¿µä¸ºçš„æ˜¯å°†Regon Proposalèå…¥ç½‘ç»œï¼Œä½¿å¾—çœŸæ­£åšåˆ°ç«¯åˆ°ç«¯çš„æ£€æµ‹æ¨¡å‹

#### 5.1.1 åŸºæœ¬æ¶æ„å›¾

![Faster-R-CNN](å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“/Faster-R-CNN.png)

#### 5.1.2 æœºåˆ¶

>  RPNæ‰€éœ€è¦è§£å†³çš„å°±æ˜¯æå‡ºæœ‰ç‰©ä½“çš„åŒºåŸŸçš„å¤§è‡´ä½ç½®ï¼Œä½ç½®çš„çŸ«æ­£å¯ä»¥åœ¨åé¢é€šè¿‡Bounding Box Regressorå®ç°

**ç›®æ ‡**ï¼šå°±æ˜¯è¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œè¾“å‡ºå›¾ç‰‡ä¸­å«æœ‰ç‰©ä½“çš„åŒºåŸŸä½ç½®ï¼ˆxï¼Œyï¼Œwï¼Œhï¼‰

â€‹	RPNå±‚æ˜¯å…¨è¿æ¥ç½‘ç»œï¼Œè¾“å…¥çš„è·å–æ˜¯é€šè¿‡ä¸€ä¸ªnxnçš„sliding windowåœ¨conv feature mapä¸Šå–å€¼ï¼ˆconv feature mapæ˜¯é€šè¿‡å¤šå±‚å·ç§¯å±‚çš„ç»“æœï¼Œå¦‚ï¼šVGGï¼ŒZFNetï¼‰ï¼Œfeature mapçš„åƒç´ ç‚¹è¦ä½œä¸ºsliding windowçš„ä¸­å¿ƒåšä¸€æ¬¡RPNæ“ä½œã€‚

â€‹	sliding windowä¸­çš„å€¼é€šè¿‡ä¸€ä¸ªå…¨è¿æ¥å±‚å¾—åˆ°ä¸€ç»´å‘é‡ï¼Œä¸€ç»´å‘é‡å†åœ¨ä¸¤ä¸ªå¹¶è¡Œçš„å…¨è¿æ¥ç½‘ç»œï¼ˆsibling layerï¼‰ï¼Œä¸€ä¸ªæ˜¯cls layerï¼Œå¦ä¸€ä¸ªæ˜¯reg layerï¼›

â€‹	è¿™ä¸ªsliding windowçš„ä¸­å¿ƒå¯ä»¥æ˜ å°„å›åŸå›¾çš„åŒºåŸŸï¼Œå¾—åˆ°åŸå›¾çš„å¯¹åº”åŒºåŸŸï¼ˆanchorï¼‰çš„ä¸­å¿ƒç‚¹ï¼Œè€Œæˆ‘ä»¬ä»¥è¿™ä¸ªä¸­å¿ƒä¸ºå›ºå®šç‚¹ï¼Œè®¾å®šå‡ ä¸ªå›ºå®šå°ºåº¦ï¼Œå›ºå®šç¼©æ”¾çš„åŒºåŸŸï¼Œè¿™æ ·ä¸€ä¸ªconv feature mapçš„ç‚¹å¯ä»¥æ˜ å°„å›å»å¤šä¸ªåŒºåŸŸï¼ˆanchorï¼‰ï¼›è¿™é‡Œæˆ‘ä»¬å‡å®šæ˜¯kä¸ªanchorsï¼Œé‚£å¯¹äºcls layer å°±æœ‰2kä¸ªè¾“å‡ºï¼Œä»£è¡¨ï¼ˆæœ‰ç‰©ä½“/æ²¡æœ‰ç‰©ä½“ï¼‰çš„å¾—åˆ†ï¼Œreg layerå°±æœ‰4kä¸ªè¾“å‡ºï¼ˆä»£è¡¨æœ‰ç‰©ä½“çš„åŒºåŸŸçš„å¯¹åº”ä½ç½®ï¼‰ã€‚

> anchor ğŸ‘‡

![anchor](å›¾åƒæ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‘å±•æ€»ç»“/anchor.png)

â€‹	è®­ç»ƒå¥½RPNåå°±èƒ½ï¼Œå°†æå–çš„proposalsç”¨åˆ°Fast R-CNNä¸­ï¼Œè¿›è¡Œåˆ†ç±»å’Œbbox regressorï¼›å…¶å®è¿™é‡ŒFast R-CNNéœ€è¦å’ŒRPNç½‘ç»œæ˜¯å…±äº«ç‰¹å¾çš„ï¼Œå³è¾“å…¥çš„ç‰¹å¾æ¥è‡ªä¸€ä¸ªå·ç§¯ç½‘ç»œçš„ç‰¹å¾æå–ï¼›é‚£ä¹ˆè¿™æ ·å­å¤šä¸ªlosså¦‚ä½•è®­ç»ƒå‘¢ï¼Œè¿™é‡Œéœ€è¦ä¸€å®šçš„è®­ç»ƒæŠ€å·§ï¼šè½®æµè®­ç»ƒï¼Œè”åˆè®­ç»ƒï¼ˆç”±äºæˆ‘æ²¡æœ‰æ“ä½œç»éªŒï¼Œè¿™é‡Œæ²¡æœ‰ç»†è¯´ï¼‰



> References:
>
> [è®ºæ–‡ç¬”è®° ã€ŠFast R-CNNã€‹](https://blog.csdn.net/u010678153/article/details/46891655)
>
> [ã€ç›®æ ‡æ£€æµ‹ã€‘Faster RCNNç®—æ³•è¯¦è§£ ]( https://blog.csdn.net/shenxiaolu1984/article/details/51152614)
>
> [rcnn spp_net](http://www.cnblogs.com/rocbomb/p/4428946.html)
>
> [ä½ åº”è¯¥çŸ¥é“çš„9ç¯‡æ·±åº¦å­¦ä¹ è®ºæ–‡ï¼ˆCNNs ç†è§£ï¼‰](https://blog.csdn.net/feimengjuan/article/details/69666981)
>
> [åˆ†ç±»ä»¥åŠç›®æ ‡æ£€æµ‹å‘å±•è„‰ç»œâ€”â€”ä»12åˆ°17](https://blog.csdn.net/wangqingbaidu/article/details/79280212)

